# [durkachatbot](https://t.me/durkachatbot)
### Телеграмм бот для определения психологического расстройства по сообщению

Бот принимает сообщения на русском и предсказывает вероятности дринадлежности текста к одному из расстройств. Для предсказания бот может использовать три модели машинного обучения: линейную логистическую регрессию, градиентный бустинг (catbost) и нейронную сеть.<br>
### [Источник датасета](https://www.kaggle.com/datasets/suchintikasarkar/sentiment-analysis-for-mental-health)


## Пайплайн предсказания психического расстройства

1. Считывается текст в сообщении
2. Текст с помошью библиотеки googletrans переводится на английский
3. Текст на английском преобразуется в эмбединг с помошью  модели all-MiniLM-L6-v2 из библиотеки sentence-transformer
4. По эмбедингам делается предсказания диагнозов
5. Результат выводится пользоваелю

## Качество моделей

Значения метрик считались как среднечзвешанное метрик для каждого класса

| Модель            | precision | recall| f1 score| ROC AUC
|-------------------|-----------|-------|---------|--------
| Градинтный бустинг|  0.879    | 0.863 |  0.863  | 0.973
| Линейная модель   |  0.758    | 0.725 |  0.732  | 0.934
| Нейронная сеть    |  0.77     | 0.75  |  0.753  | 0.942



## Описание файлов
| Вайл                | Описание
|---------------------|--------------------------------------------
| bot.py	          | Исполняемый файл для бота 
| create_base.py      | Скрипт для создания пустой базы данных с настройками для чатов, в которых есть бот 
| requirements.txt    | Файл со списком необходимых библиотек 
| dataset.csv	      | Датасет, по которому обучался бот 
| preprocessing.ipynb | Ноутбук с предобработкой датасета
| train.ipynb	      | Ноутбук с обучением моделей